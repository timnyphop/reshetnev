"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.addProviderToBootstrapApplicationFn = void 0;
const ts_morph_1 = require("ts-morph");
const push_to_object_literal_array_property_1 = require("../helpers/push-to-object-literal-array-property");
function addProviderToBootstrapApplicationFn(callExpression, provider, { unique = false } = {}) {
    const [, options = callExpression.addArgument('{providers: []}')] = callExpression.getArguments();
    if (!ts_morph_1.Node.isIdentifier(options) && !ts_morph_1.Node.isObjectLiteralExpression(options)) {
        return;
    }
    const expression = getOptionsObject(options);
    if (expression) {
        (0, push_to_object_literal_array_property_1.pushToObjectLiteralArrayProperty)(expression, 'providers', provider, { unique });
    }
}
exports.addProviderToBootstrapApplicationFn = addProviderToBootstrapApplicationFn;
function getOptionsObject(options) {
    if (ts_morph_1.Node.isObjectLiteralExpression(options)) {
        return options;
    }
    const definition = options.getDefinitionNodes()[0];
    return definition === null || definition === void 0 ? void 0 : definition.getChildrenOfKind(ts_morph_1.SyntaxKind.ObjectLiteralExpression)[0];
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWRkLXByb3ZpZGVyLXRvLWJvb3RzdHJhcC1hcHBsaWNhdGlvbi1mbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvbmctbW9ycGgvc3JjL25nL2Jvb3RzdHJhcC9hZGQtcHJvdmlkZXItdG8tYm9vdHN0cmFwLWFwcGxpY2F0aW9uLWZuLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUNBLHVDQUEwQztBQUUxQyw0R0FBa0c7QUFFbEcsU0FBZ0IsbUNBQW1DLENBQy9DLGNBQThCLEVBQzlCLFFBQWdCLEVBQ2hCLEVBQUMsTUFBTSxHQUFHLEtBQUssS0FBd0IsRUFBRTtJQUV6QyxNQUFNLENBQUMsRUFBRSxPQUFPLEdBQUcsY0FBYyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLEdBQzdELGNBQWMsQ0FBQyxZQUFZLEVBQUUsQ0FBQztJQUVsQyxJQUFJLENBQUMsZUFBSSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLGVBQUksQ0FBQyx5QkFBeUIsQ0FBQyxPQUFPLENBQUMsRUFBRTtRQUN6RSxPQUFPO0tBQ1Y7SUFFRCxNQUFNLFVBQVUsR0FBRyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUU3QyxJQUFJLFVBQVUsRUFBRTtRQUNaLElBQUEsd0VBQWdDLEVBQUMsVUFBVSxFQUFFLFdBQVcsRUFBRSxRQUFRLEVBQUUsRUFBQyxNQUFNLEVBQUMsQ0FBQyxDQUFDO0tBQ2pGO0FBQ0wsQ0FBQztBQWpCRCxrRkFpQkM7QUFFRCxTQUFTLGdCQUFnQixDQUNyQixPQUE2QztJQUU3QyxJQUFJLGVBQUksQ0FBQyx5QkFBeUIsQ0FBQyxPQUFPLENBQUMsRUFBRTtRQUN6QyxPQUFPLE9BQU8sQ0FBQztLQUNsQjtJQUVELE1BQU0sVUFBVSxHQUFHLE9BQU8sQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRW5ELE9BQU8sVUFBVSxhQUFWLFVBQVUsdUJBQVYsVUFBVSxDQUFFLGlCQUFpQixDQUFDLHFCQUFVLENBQUMsdUJBQXVCLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDaEYsQ0FBQyJ9