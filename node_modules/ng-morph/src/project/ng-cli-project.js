"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.NgCliProject = void 0;
const tslib_1 = require("tslib");
const ts_morph_1 = require("ts-morph");
const devkit_file_system_1 = require("./devkit-file-system");
const file_system_1 = require("./file-system");
const ng_morph_tree_1 = require("./ng-morph-tree");
class NgCliProject extends ts_morph_1.Project {
    constructor(_a) {
        var { host } = _a, options = tslib_1.__rest(_a, ["host"]);
        super(Object.assign(Object.assign({}, options), { fileSystem: new file_system_1.NgCliFileSystem(new devkit_file_system_1.DevkitFileSystem(host)) }));
    }
    getFileSystem() {
        return super.getFileSystem();
    }
    async save() {
        await super.save();
        await this.trySaveTree();
    }
    saveSync() {
        super.saveSync();
        void this.trySaveTree();
    }
    async trySaveTree() {
        const tree = this.getFileSystem().fs.tree;
        if (tree instanceof ng_morph_tree_1.NgMorphTree) {
            await tree.commitChanges();
        }
    }
}
exports.NgCliProject = NgCliProject;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmctY2xpLXByb2plY3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9saWJzL25nLW1vcnBoL3NyYy9wcm9qZWN0L25nLWNsaS1wcm9qZWN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSx1Q0FBaUM7QUFFakMsNkRBQXNEO0FBQ3RELCtDQUE4QztBQUU5QyxtREFBNEM7QUFFNUMsTUFBYSxZQUFhLFNBQVEsa0JBQU87SUFDckMsWUFBWSxFQUF1QztZQUF2QyxFQUFDLElBQUksT0FBa0MsRUFBN0IsT0FBTyxzQkFBakIsUUFBa0IsQ0FBRDtRQUN6QixLQUFLLGlDQUNFLE9BQU8sS0FDVixVQUFVLEVBQUUsSUFBSSw2QkFBZSxDQUFDLElBQUkscUNBQWdCLENBQUMsSUFBSSxDQUFDLENBQUMsSUFDN0QsQ0FBQztJQUNQLENBQUM7SUFFZSxhQUFhO1FBQ3pCLE9BQU8sS0FBSyxDQUFDLGFBQWEsRUFBcUIsQ0FBQztJQUNwRCxDQUFDO0lBRWUsS0FBSyxDQUFDLElBQUk7UUFDdEIsTUFBTSxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDbkIsTUFBTSxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDN0IsQ0FBQztJQUVlLFFBQVE7UUFDcEIsS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ2pCLEtBQUssSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQzVCLENBQUM7SUFFTyxLQUFLLENBQUMsV0FBVztRQUNyQixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQztRQUUxQyxJQUFJLElBQUksWUFBWSwyQkFBVyxFQUFFO1lBQzdCLE1BQU0sSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1NBQzlCO0lBQ0wsQ0FBQztDQUNKO0FBN0JELG9DQTZCQyJ9