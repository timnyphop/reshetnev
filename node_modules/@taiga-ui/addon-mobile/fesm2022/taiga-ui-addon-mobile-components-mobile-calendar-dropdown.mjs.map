{"version":3,"file":"taiga-ui-addon-mobile-components-mobile-calendar-dropdown.mjs","sources":["../../../projects/addon-mobile/components/mobile-calendar-dropdown/mobile-calendar-dropdown.component.ts","../../../projects/addon-mobile/components/mobile-calendar-dropdown/mobile-calendar-dropdown.template.html","../../../projects/addon-mobile/components/mobile-calendar-dropdown/taiga-ui-addon-mobile-components-mobile-calendar-dropdown.ts"],"sourcesContent":["import type {ValueProvider} from '@angular/core';\nimport {ChangeDetectionStrategy, Component, inject} from '@angular/core';\nimport {TuiMobileCalendar} from '@taiga-ui/addon-mobile/components/mobile-calendar';\nimport {TuiKeyboardService} from '@taiga-ui/addon-mobile/services';\nimport {TuiControl} from '@taiga-ui/cdk/classes';\nimport {TUI_FALSE_HANDLER} from '@taiga-ui/cdk/constants';\nimport type {TuiDay} from '@taiga-ui/cdk/date-time';\nimport {TUI_FIRST_DAY, TUI_LAST_DAY} from '@taiga-ui/cdk/date-time';\nimport {TuiActiveZone} from '@taiga-ui/cdk/directives/active-zone';\nimport type {TuiBooleanHandler} from '@taiga-ui/cdk/types';\nimport {tuiFadeIn, tuiSlideInTop} from '@taiga-ui/core/animations';\nimport {TuiDropdownDirective} from '@taiga-ui/core/directives/dropdown';\nimport {TUI_ANIMATIONS_SPEED} from '@taiga-ui/core/tokens';\nimport {tuiGetDuration} from '@taiga-ui/core/utils/miscellaneous';\nimport {TUI_DAY_CAPS_MAPPER} from '@taiga-ui/kit/components/calendar-range';\nimport {TUI_MOBILE_CALENDAR} from '@taiga-ui/kit/tokens';\nimport {injectContext} from '@taiga-ui/polymorpheus';\nimport type {Observer} from 'rxjs';\n\nexport interface TuiMobileCalendarData {\n    disabledItemHandler?: TuiBooleanHandler<TuiDay>;\n    max?: TuiDay | null;\n    min?: TuiDay | null;\n    multi?: boolean;\n    single?: boolean;\n}\n\n@Component({\n    standalone: true,\n    selector: 'tui-mobile-calendar-dropdown',\n    imports: [TuiMobileCalendar],\n    templateUrl: './mobile-calendar-dropdown.template.html',\n    styleUrls: ['./mobile-calendar-dropdown.style.less'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    animations: [tuiSlideInTop, tuiFadeIn],\n    hostDirectives: [TuiActiveZone],\n    host: {\n        '[@tuiSlideInTop]': 'animation',\n        '[@tuiFadeIn]': 'animation',\n    },\n})\nexport class TuiMobileCalendarDropdown {\n    // TODO: Rework to use TuiDropdownOpenDirective so the focus returns to the field on closing\n    private readonly dropdown = inject(TuiDropdownDirective, {optional: true});\n    private readonly keyboard = inject(TuiKeyboardService);\n    private readonly context = injectContext<Record<string, any>>({optional: true});\n    private readonly observer?: Observer<any> = this.context?.$implicit;\n    private readonly data: TuiMobileCalendarData = this.context?.data || {};\n\n    protected readonly animation = {\n        value: '',\n        params: {\n            start: '100vh',\n            duration: tuiGetDuration(inject(TUI_ANIMATIONS_SPEED)),\n        },\n    };\n\n    // TODO: Refactor to proper Date, DateMulti and DateRange components after they are added to kit\n    protected readonly control: any = inject(TuiControl, {optional: true});\n    protected readonly range = this.is('tui-input-date-range');\n    protected readonly multi = this.data.multi || this.is('tui-input-date[multiple]');\n    protected readonly single =\n        this.data.single || this.is('tui-input-date:not([multiple])');\n\n    protected readonly min =\n        this.data.min ||\n        (this.range\n            ? TUI_DAY_CAPS_MAPPER(\n                  this.control.min,\n                  this.control.value,\n                  this.control.maxLength,\n                  true,\n              )\n            : this.control?.min) ||\n        TUI_FIRST_DAY;\n\n    protected readonly max =\n        this.data.max ||\n        (this.range\n            ? TUI_DAY_CAPS_MAPPER(\n                  this.control.max,\n                  this.control.value,\n                  this.control.maxLength,\n                  false,\n              )\n            : this.control?.max) ||\n        TUI_LAST_DAY;\n\n    protected readonly disabledItemHandler =\n        this.data.disabledItemHandler ||\n        this.control?.disabledItemHandler ||\n        TUI_FALSE_HANDLER;\n\n    constructor() {\n        this.keyboard.hide();\n    }\n\n    protected close(): void {\n        this.dropdown?.toggle(false);\n        this.observer?.complete();\n        this.keyboard.show();\n    }\n\n    protected confirm(value: any): void {\n        if (this.control) {\n            this.control.value = value;\n        }\n\n        this.observer?.next(value);\n        this.close();\n    }\n\n    private is(selector: string): boolean {\n        return !!this.dropdown?.el.closest(selector);\n    }\n}\n\nexport function tuiProvideMobileCalendar(): ValueProvider {\n    return {\n        provide: TUI_MOBILE_CALENDAR,\n        useValue: TuiMobileCalendarDropdown,\n    };\n}\n","<tui-mobile-calendar\n    [disabledItemHandler]=\"disabledItemHandler\"\n    [max]=\"max\"\n    [min]=\"min\"\n    [multi]=\"multi\"\n    [single]=\"single\"\n    (cancel)=\"close()\"\n    (confirm)=\"confirm($event)\"\n/>\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}