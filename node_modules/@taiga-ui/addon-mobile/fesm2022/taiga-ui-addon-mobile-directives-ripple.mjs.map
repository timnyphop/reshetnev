{"version":3,"file":"taiga-ui-addon-mobile-directives-ripple.mjs","sources":["../../../projects/addon-mobile/directives/ripple/ripple.directive.ts","../../../projects/addon-mobile/directives/ripple/taiga-ui-addon-mobile-directives-ripple.ts"],"sourcesContent":["import {DOCUMENT} from '@angular/common';\nimport {\n    ChangeDetectionStrategy,\n    Component,\n    DestroyRef,\n    Directive,\n    inject,\n    Input,\n    ViewEncapsulation,\n} from '@angular/core';\nimport {takeUntilDestroyed} from '@angular/core/rxjs-interop';\nimport {tuiTypedFromEvent} from '@taiga-ui/cdk/observables';\nimport {tuiIsHTMLElement} from '@taiga-ui/cdk/utils/dom';\nimport {tuiPx, tuiWithStyles} from '@taiga-ui/cdk/utils/miscellaneous';\nimport {TUI_ANIMATIONS_SPEED} from '@taiga-ui/core/tokens';\nimport {tuiGetDuration} from '@taiga-ui/core/utils/miscellaneous';\nimport {first, merge, race, switchMap, tap} from 'rxjs';\n\nconst TO_KEYFRAMES = [\n    {\n        transform: 'scale(0)',\n        opacity: '0.12',\n    },\n    {\n        opacity: '0.12',\n    },\n];\nconst FROM_KEYFRAMES = [\n    {\n        opacity: '0.12',\n    },\n    {\n        opacity: '0',\n    },\n];\n\n@Component({\n    standalone: true,\n    template: '',\n    styleUrls: ['./ripple.style.less'],\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    host: {\n        class: 'tui-ripple-styles',\n    },\n})\nclass TuiRippleStyles {}\n\n@Directive({\n    standalone: true,\n    selector: '[tuiRipple]',\n    host: {\n        '(pointerdown.silent)':\n            'start($event.clientX, $event.clientY, $event.target, $event.currentTarget)',\n    },\n})\nexport class TuiRipple {\n    private readonly document = inject(DOCUMENT);\n    private readonly destroyRef = inject(DestroyRef);\n    private readonly animationOptions = {\n        duration: tuiGetDuration(inject(TUI_ANIMATIONS_SPEED)),\n    };\n\n    protected readonly nothing = tuiWithStyles(TuiRippleStyles);\n\n    @Input()\n    public tuiRipple: string | '' = '';\n\n    protected start(x: number, y: number, target: HTMLElement, el: HTMLElement): void {\n        const element = this.tuiRipple ? target.closest(this.tuiRipple) : el;\n\n        if (!tuiIsHTMLElement(element)) {\n            return;\n        }\n\n        const ripple = this.createRipple(x, y, element.getBoundingClientRect());\n        const touchEnd$ = merge(\n            tuiTypedFromEvent(element, 'pointerup'),\n            tuiTypedFromEvent(element, 'pointercancel'),\n            tuiTypedFromEvent(element, 'pointermove'),\n        );\n\n        element.appendChild(ripple);\n\n        const animationEndOn$ = tuiTypedFromEvent(\n            ripple.animate(TO_KEYFRAMES, this.animationOptions),\n            'finish',\n        );\n\n        race(\n            touchEnd$.pipe(switchMap(() => animationEndOn$)),\n            animationEndOn$.pipe(switchMap(() => touchEnd$)),\n        )\n            .pipe(\n                first(),\n                switchMap(() =>\n                    tuiTypedFromEvent(\n                        ripple.animate(FROM_KEYFRAMES, this.animationOptions),\n                        'finish',\n                    ),\n                ),\n                first(),\n                tap(() => element.removeChild(ripple)),\n                takeUntilDestroyed(this.destroyRef),\n            )\n            .subscribe();\n    }\n\n    private createRipple(\n        clientX: number,\n        clientY: number,\n        {width, height, top, left}: DOMRect,\n    ): HTMLElement {\n        const ripple: HTMLElement = this.document.createElement('div');\n        const radius = Math.sqrt(width * width + height * height);\n        const dimension = radius * 2;\n        const x = clientX - left - radius;\n        const y = clientY - top - radius;\n\n        Object.assign(ripple.style, {\n            position: 'absolute',\n            top: tuiPx(y),\n            left: tuiPx(x),\n            width: tuiPx(dimension),\n            height: tuiPx(dimension),\n            zIndex: 100,\n            opacity: 0.12,\n            borderRadius: '100%',\n            background: 'var(--tui-ripple-background, currentColor)',\n            animationFillMode: 'forwards',\n            pointerEvents: 'none',\n        });\n\n        return ripple;\n    }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}