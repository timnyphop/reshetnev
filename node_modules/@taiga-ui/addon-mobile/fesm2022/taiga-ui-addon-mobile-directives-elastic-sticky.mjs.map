{"version":3,"file":"taiga-ui-addon-mobile-directives-elastic-sticky.mjs","sources":["../../../projects/addon-mobile/directives/elastic-sticky/elastic-sticky.service.ts","../../../projects/addon-mobile/directives/elastic-sticky/elastic-sticky.directive.ts","../../../projects/addon-mobile/directives/elastic-sticky/taiga-ui-addon-mobile-directives-elastic-sticky.ts"],"sourcesContent":["import {\n    afterNextRender,\n    ChangeDetectorRef,\n    DestroyRef,\n    inject,\n    Injectable,\n    INJECTOR,\n    NgZone,\n} from '@angular/core';\nimport {takeUntilDestroyed} from '@angular/core/rxjs-interop';\nimport {tuiScrollFrom, tuiZonefree} from '@taiga-ui/cdk/observables';\nimport {tuiGetElementOffset, tuiInjectElement} from '@taiga-ui/cdk/utils/dom';\nimport {SCROLL_REF_SELECTOR} from '@taiga-ui/core/components/scrollbar';\nimport {TUI_SCROLL_REF} from '@taiga-ui/core/tokens';\nimport {map, Observable, Subscription, tap} from 'rxjs';\n\n@Injectable()\nexport class TuiElasticStickyService extends Observable<number> {\n    private readonly injector = inject(INJECTOR);\n    private readonly el = tuiInjectElement();\n    private readonly scrollRef = inject(TUI_SCROLL_REF).nativeElement;\n    private readonly zone = inject(NgZone);\n    private readonly cd = inject(ChangeDetectorRef);\n    private readonly destroyRef = inject(DestroyRef);\n\n    constructor() {\n        super((subscriber) => {\n            const subscription = new Subscription();\n\n            afterNextRender(\n                () => {\n                    const host = this.el.closest(SCROLL_REF_SELECTOR) || this.scrollRef;\n                    const {offsetTop} = tuiGetElementOffset(host, this.el);\n                    const {offsetHeight} = this.el;\n                    const teardown = tuiScrollFrom(host)\n                        .pipe(\n                            tuiZonefree(this.zone),\n                            map(() =>\n                                Math.max(\n                                    1 -\n                                        Math.max(\n                                            Math.round(host.scrollTop) - offsetTop,\n                                            0,\n                                        ) /\n                                            offsetHeight,\n                                    0,\n                                ),\n                            ),\n                            tap(() => this.cd.detectChanges()),\n                            takeUntilDestroyed(this.destroyRef),\n                        )\n                        .subscribe(subscriber);\n\n                    if (!subscription.closed) {\n                        subscription.add(teardown);\n                    } else {\n                        teardown.unsubscribe();\n                    }\n                },\n                {injector: this.injector},\n            );\n\n            return subscription;\n        });\n    }\n}\n","import {Directive, inject, Output} from '@angular/core';\n\nimport {TuiElasticStickyService} from './elastic-sticky.service';\n\n@Directive({\n    standalone: true,\n    selector: '[tuiElasticSticky]',\n    providers: [TuiElasticStickyService],\n    exportAs: 'tuiElasticSticky',\n})\nexport class TuiElasticSticky {\n    @Output()\n    public readonly tuiElasticSticky = inject(TuiElasticStickyService);\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}