import { InjectionToken, Optional, Self } from '@angular/core';
import { NgControl } from '@angular/forms';
import { tuiControlValue } from '@taiga-ui/cdk/observables';
import { map, of } from 'rxjs';
/**
 * Stream that emits calendar data change
 */
export const TUI_CALENDAR_DATE_STREAM = new InjectionToken('[TUI_CALENDAR_DATE_STREAM]');
export function tuiDateStreamWithTransformer(transformer) {
    return {
        provide: TUI_CALENDAR_DATE_STREAM,
        deps: [
            [new Optional(), new Self(), NgControl],
            [new Optional(), transformer],
        ],
        useFactory: tuiControlValueFactory,
    };
}
function tuiControlValueFactory(control, transformer) {
    return control
        ? tuiControlValue(control).pipe(map((value) => transformer ? transformer?.fromControlValue(value) : value))
        : of(null);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsZW5kYXItZGF0ZS1zdHJlYW0uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9raXQvdG9rZW5zL2NhbGVuZGFyLWRhdGUtc3RyZWFtLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBQyxjQUFjLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUM3RCxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFHekMsT0FBTyxFQUFDLGVBQWUsRUFBQyxNQUFNLDJCQUEyQixDQUFDO0FBRTFELE9BQU8sRUFBQyxHQUFHLEVBQUUsRUFBRSxFQUFDLE1BQU0sTUFBTSxDQUFDO0FBRTdCOztHQUVHO0FBQ0gsTUFBTSxDQUFDLE1BQU0sd0JBQXdCLEdBQUcsSUFBSSxjQUFjLENBRXhELDRCQUE0QixDQUFDLENBQUM7QUFFaEMsTUFBTSxVQUFVLDRCQUE0QixDQUN4QyxXQUFxRDtJQUVyRCxPQUFPO1FBQ0gsT0FBTyxFQUFFLHdCQUF3QjtRQUNqQyxJQUFJLEVBQUU7WUFDRixDQUFDLElBQUksUUFBUSxFQUFFLEVBQUUsSUFBSSxJQUFJLEVBQUUsRUFBRSxTQUFTLENBQUM7WUFDdkMsQ0FBQyxJQUFJLFFBQVEsRUFBRSxFQUFFLFdBQVcsQ0FBQztTQUNoQztRQUNELFVBQVUsRUFBRSxzQkFBc0I7S0FDckMsQ0FBQztBQUNOLENBQUM7QUFFRCxTQUFTLHNCQUFzQixDQUczQixPQUF5QixFQUN6QixXQUEyQztJQUUzQyxPQUFPLE9BQU87UUFDVixDQUFDLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FDekIsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FDVixXQUFXLENBQUMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUUsS0FBVyxDQUNwRSxDQUNKO1FBQ0gsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNuQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUge1Byb3ZpZGVyfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7SW5qZWN0aW9uVG9rZW4sIE9wdGlvbmFsLCBTZWxmfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7TmdDb250cm9sfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgdHlwZSB7VHVpVmFsdWVUcmFuc2Zvcm1lcn0gZnJvbSAnQHRhaWdhLXVpL2Nkay9jbGFzc2VzJztcbmltcG9ydCB0eXBlIHtUdWlEYXksIFR1aURheVJhbmdlLCBUdWlUaW1lfSBmcm9tICdAdGFpZ2EtdWkvY2RrL2RhdGUtdGltZSc7XG5pbXBvcnQge3R1aUNvbnRyb2xWYWx1ZX0gZnJvbSAnQHRhaWdhLXVpL2Nkay9vYnNlcnZhYmxlcyc7XG5pbXBvcnQgdHlwZSB7T2JzZXJ2YWJsZX0gZnJvbSAncnhqcyc7XG5pbXBvcnQge21hcCwgb2Z9IGZyb20gJ3J4anMnO1xuXG4vKipcbiAqIFN0cmVhbSB0aGF0IGVtaXRzIGNhbGVuZGFyIGRhdGEgY2hhbmdlXG4gKi9cbmV4cG9ydCBjb25zdCBUVUlfQ0FMRU5EQVJfREFURV9TVFJFQU0gPSBuZXcgSW5qZWN0aW9uVG9rZW48XG4gICAgT2JzZXJ2YWJsZTxUdWlEYXkgfCBUdWlEYXlSYW5nZSB8IG51bGw+XG4+KCdbVFVJX0NBTEVOREFSX0RBVEVfU1RSRUFNXScpO1xuXG5leHBvcnQgZnVuY3Rpb24gdHVpRGF0ZVN0cmVhbVdpdGhUcmFuc2Zvcm1lcihcbiAgICB0cmFuc2Zvcm1lcjogSW5qZWN0aW9uVG9rZW48VHVpVmFsdWVUcmFuc2Zvcm1lcjxhbnk+Pixcbik6IFByb3ZpZGVyIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm92aWRlOiBUVUlfQ0FMRU5EQVJfREFURV9TVFJFQU0sXG4gICAgICAgIGRlcHM6IFtcbiAgICAgICAgICAgIFtuZXcgT3B0aW9uYWwoKSwgbmV3IFNlbGYoKSwgTmdDb250cm9sXSxcbiAgICAgICAgICAgIFtuZXcgT3B0aW9uYWwoKSwgdHJhbnNmb3JtZXJdLFxuICAgICAgICBdLFxuICAgICAgICB1c2VGYWN0b3J5OiB0dWlDb250cm9sVmFsdWVGYWN0b3J5LFxuICAgIH07XG59XG5cbmZ1bmN0aW9uIHR1aUNvbnRyb2xWYWx1ZUZhY3Rvcnk8XG4gICAgVCBleHRlbmRzIFR1aURheSB8IFR1aURheVJhbmdlIHwgW1R1aURheSB8IG51bGwsIFR1aVRpbWUgfCBudWxsXSxcbj4oXG4gICAgY29udHJvbDogTmdDb250cm9sIHwgbnVsbCxcbiAgICB0cmFuc2Zvcm1lcj86IFR1aVZhbHVlVHJhbnNmb3JtZXI8VD4gfCBudWxsLFxuKTogT2JzZXJ2YWJsZTxUIHwgbnVsbD4gfCBudWxsIHtcbiAgICByZXR1cm4gY29udHJvbFxuICAgICAgICA/IHR1aUNvbnRyb2xWYWx1ZShjb250cm9sKS5waXBlKFxuICAgICAgICAgICAgICBtYXAoKHZhbHVlKSA9PlxuICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtZXIgPyB0cmFuc2Zvcm1lcj8uZnJvbUNvbnRyb2xWYWx1ZSh2YWx1ZSkgOiAodmFsdWUgYXMgVCksXG4gICAgICAgICAgICAgICksXG4gICAgICAgICAgKVxuICAgICAgICA6IG9mKG51bGwpO1xufVxuIl19